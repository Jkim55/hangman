<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Code Challenge: A Game of Hangman</title>
  </head>
  <body>
    <script>
      // FUNCTION: add the formatStringNicely function to String.prototype
      String.prototype.formatStringNicely = function() {
        return this.charAt(0).toUpperCase() + this.slice(1).toLowerCase() // this.charAt() is faster than this[0]
      }

      // Get the name of a player, format that name, and greet the player
      var getName = function(){
        var name = prompt("What's your name?")
        return name.formatStringNicely()
      }
      var greetPlayer = function(playerName){
        alert("Hi, " + playerName + "! How about a game of Hangman?")
      }

      // Pick a word randomly from an array chosen at random
      var capitals = ["ankara", "paris", "athens", "london", "jakarta", "berlin", "helsinki", "stockholm"]
      var morningDrinks = ["coffee", "tea", "water", "oj", "milk", "smoothie", "espresso"]
      var aromatherapyScents =["huckleberry", "rose", "jasmine", "bergamont", "vanilla", "lavender", "hyssop", "orange"]
      var defaultListArray = [capitals, morningDrinks, aromatherapyScents]

      var pickWordList = function(listArray){
        return listArray[Math.floor(Math.random()* listArray.length)]
      }
      var pickWord = function (wordList){
        return wordList[Math.floor(Math.random()* wordList.length)]
      }

      /* FUNCTION: inform player that word has been chosen and what the category is
      var findCategory = function(listArray, selectedList){
        for (var i=0;i>listArray.length; i++){
          if (listArray[i] == selectedList){
            break;
          }
        }
        return listArray[i]
      }
      var announceWordSelected = function(category, word){
        alert("A random word has been selected from the category " + category + " and it consists of " + word.length + " letters")
      }*/

      // Translate the selectedWord into blanks
      var setupAnswerArray = function(selectedWord){
        var answerArray = []
        for (var i=0; i<selectedWord.length; i++){
          answerArray[i] = "_"
        }
        return answerArray
      }

      // Setting up a counter to show remaining letters within word
      var remainingLetters = function(selectedWord){ //counter re # of words to be guessed
        return selectedWord.length
      }

      // Show current state of answerArray
      var showPlayerProgress = function(currentAnswerArray){
        return currentAnswerArray.join(" ")  //show player their progress by printing out current state of answerArray
      }

      //*******************************************************************************************//
      var matchLetter = function(word, arr, counter, guess){
        for (var j=0; j<word.length; j++){
          if (word[j] === guess.toString()){
            arr[j] = guess;
            counter--;
            break;
          }
          else {
            alert("The letter " + guess + " doesn't exist.")
          }
        }
      }

      // FUNCTION: alerts re status of the game after the game is over
      var quitGameAndShowAnswer = function(selectedWord){
        alert("The correct answer was " + selectedWord.formatStringNicely() + ". Better luck next time! :D");
      }
      var showAnswerAndCongratulatePlayer = function(selectedWord){
        alert("Good game! The answer was " + selectedWord.formatStringNicely() + ".")
      }
      var endOfGameMessage = function(selectedWord, remainingLettersCounter){
        if (remainingLettersCounter === 0){
          showAnswerAndCongratulatePlayer(selectedWord)
        } else {
          quitGameAndShowAnswer(selectedWord)
        }
      }

      // Game time! Code for actual game
      var getGuess = function(word, answerArray, counter){
        while (counter > 0) {
          alert(showPlayerProgress(answerArray))
          var guess = prompt("Guess a letter or type 'quit' to stop playing") // take input from the player
          if (guess === 'quit'){
            alert("OK-let's play next time!")
            break;
          }
          else if (guess.length !== 1){
            alert("Please guess only one letter at a time!")
          }
          else {
              matchLetter(word, answerArray, counter, guess)
          }
        }
        endOfGameMessage(word, counter)
      }


      //**** START: CODE TO RUN GAME **** //
      greetPlayer(getName())
      var selectedList = pickWordList(defaultListArray)
      console.log("Value of selectedList:" + selectedList)

      var selectedWord = pickWord(selectedList)
      console.log("Value of selectedWord:" + selectedWord)

      var answerArray = setupAnswerArray(selectedWord)
      console.log("Value of answerArray:" + answerArray)

      var letterCounter = remainingLetters(selectedWord)
      console.log("Value of letterCounter:" + letterCounter)

      var playerProgress = showPlayerProgress(answerArray)

      getGuess(selectedWord, answerArray, letterCounter)

      // var nameOfSelectedList = findCategory(defaultListArray, selectedList)
      // announceWordSelected(nameOfSelectedList, selectedWord)
      // /* The findCategory & announceWordSelected FUNCTIONS do not work!!!
      // Possibly requires changing how the array of words & defaultListArray is structured to a key:value pair */

    </script>
  </body>
</html>
